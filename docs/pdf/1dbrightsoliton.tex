\documentclass[12pt,a4paper]{article}

\usepackage[a4paper,text={16.5cm,25.2cm},centering]{geometry}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{microtype}
\usepackage{hyperref}
\usepackage{mhchem}
\setlength{\parindent}{0pt}
\setlength{\parskip}{1.2ex}

\hypersetup
       {   pdfauthor = { Ashton Bradley },
           pdftitle={ Bright soliton },
           colorlinks=TRUE,
           linkcolor=black,
           citecolor=blue,
           urlcolor=blue
       }

\title{ Bright soliton }

\author{ Ashton Bradley }


\usepackage[T1]{fontenc}
\usepackage{textcomp}
\usepackage{upquote}
\usepackage{listings}
\usepackage{xcolor}
\lstset{
    basicstyle=\ttfamily\footnotesize,
    upquote=true,
    breaklines=true,
    keepspaces=true,
    showspaces=false,
    columns=fullflexible,
    showtabs=false,
    showstringspaces=false,
    escapeinside={(*@}{@*)},
    extendedchars=true,
}
\newcommand{\HLJLt}[1]{#1}
\newcommand{\HLJLw}[1]{#1}
\newcommand{\HLJLe}[1]{#1}
\newcommand{\HLJLeB}[1]{#1}
\newcommand{\HLJLo}[1]{#1}
\newcommand{\HLJLk}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkc}[1]{\textcolor[RGB]{59,151,46}{\textit{#1}}}
\newcommand{\HLJLkd}[1]{\textcolor[RGB]{214,102,97}{\textit{#1}}}
\newcommand{\HLJLkn}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkp}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkr}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLkt}[1]{\textcolor[RGB]{148,91,176}{\textbf{#1}}}
\newcommand{\HLJLn}[1]{#1}
\newcommand{\HLJLna}[1]{#1}
\newcommand{\HLJLnb}[1]{#1}
\newcommand{\HLJLnbp}[1]{#1}
\newcommand{\HLJLnc}[1]{#1}
\newcommand{\HLJLncB}[1]{#1}
\newcommand{\HLJLnd}[1]{\textcolor[RGB]{214,102,97}{#1}}
\newcommand{\HLJLne}[1]{#1}
\newcommand{\HLJLneB}[1]{#1}
\newcommand{\HLJLnf}[1]{\textcolor[RGB]{66,102,213}{#1}}
\newcommand{\HLJLnfm}[1]{\textcolor[RGB]{66,102,213}{#1}}
\newcommand{\HLJLnp}[1]{#1}
\newcommand{\HLJLnl}[1]{#1}
\newcommand{\HLJLnn}[1]{#1}
\newcommand{\HLJLno}[1]{#1}
\newcommand{\HLJLnt}[1]{#1}
\newcommand{\HLJLnv}[1]{#1}
\newcommand{\HLJLnvc}[1]{#1}
\newcommand{\HLJLnvg}[1]{#1}
\newcommand{\HLJLnvi}[1]{#1}
\newcommand{\HLJLnvm}[1]{#1}
\newcommand{\HLJLl}[1]{#1}
\newcommand{\HLJLld}[1]{\textcolor[RGB]{148,91,176}{\textit{#1}}}
\newcommand{\HLJLs}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsa}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsb}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsc}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsd}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsdB}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsdC}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLse}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLsh}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsi}[1]{#1}
\newcommand{\HLJLso}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLsr}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLss}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLssB}[1]{\textcolor[RGB]{201,61,57}{#1}}
\newcommand{\HLJLnB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnbB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnfB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnh}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLni}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnil}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLnoB}[1]{\textcolor[RGB]{59,151,46}{#1}}
\newcommand{\HLJLoB}[1]{\textcolor[RGB]{102,102,102}{\textbf{#1}}}
\newcommand{\HLJLow}[1]{\textcolor[RGB]{102,102,102}{\textbf{#1}}}
\newcommand{\HLJLp}[1]{#1}
\newcommand{\HLJLc}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLch}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcm}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcp}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcpB}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcs}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLcsB}[1]{\textcolor[RGB]{153,153,119}{\textit{#1}}}
\newcommand{\HLJLg}[1]{#1}
\newcommand{\HLJLgd}[1]{#1}
\newcommand{\HLJLge}[1]{#1}
\newcommand{\HLJLgeB}[1]{#1}
\newcommand{\HLJLgh}[1]{#1}
\newcommand{\HLJLgi}[1]{#1}
\newcommand{\HLJLgo}[1]{#1}
\newcommand{\HLJLgp}[1]{#1}
\newcommand{\HLJLgs}[1]{#1}
\newcommand{\HLJLgsB}[1]{#1}
\newcommand{\HLJLgt}[1]{#1}


\begin{document}

\maketitle

\section{Introduction}
The bright soliton provides a good test of the balance between kinetic dispersion and the attractive nonlinearity. It also tests the periodicity of the fft method. 


\begin{lstlisting}
(*@\HLJLk{using}@*) (*@\HLJLn{Plots}@*)(*@\HLJLp{,}@*) (*@\HLJLn{LaTeXStrings}@*)(*@\HLJLp{,}@*) (*@\HLJLn{Pkg}@*)(*@\HLJLp{,}@*) (*@\HLJLn{Revise}@*)
(*@\HLJLnf{gr}@*)(*@\HLJLp{(}@*)(*@\HLJLn{legend}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{,}@*)(*@\HLJLn{titlefontsize}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{12}@*)(*@\HLJLp{,}@*)(*@\HLJLn{size}@*)(*@\HLJLoB{=}@*)(*@\HLJLp{(}@*)(*@\HLJLni{500}@*)(*@\HLJLp{,}@*)(*@\HLJLni{300}@*)(*@\HLJLp{),}@*)(*@\HLJLn{colorbar}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{)}@*)
(*@\HLJLk{using}@*) (*@\HLJLn{FourierGPE}@*)
\end{lstlisting}


\section{Potential function}

\begin{lstlisting}
(*@\HLJLk{import}@*) (*@\HLJLn{FourierGPE}@*)(*@\HLJLoB{.}@*)(*@\HLJLn{V}@*)
(*@\HLJLnf{V}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x}@*)(*@\HLJLp{,}@*)(*@\HLJLn{t}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{zero}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{|>}@*) (*@\HLJLn{complex}@*)
\end{lstlisting}

\begin{lstlisting}
V (generic function with 3 methods)
\end{lstlisting}


\subsection{Units}
We work in units of ... Let's add a convenient plot

\begin{verbatim}
function showpsi(x,\ensuremath{\psi})
    p1 = plot(x,abs2.(\ensuremath{\psi}))
    xlabel!(L"x/a_x");ylabel!(L"|\psi|^2")
    p2 = plot(x,angle.(\ensuremath{\psi}))
    xlabel!(L"x/a_x");ylabel!(L"\textrm{phase}(\psi)")
    p = plot(p1,p2,layout=(2,1),size=(600,400))
    return p
end
\end{verbatim}
\subsection{User parameters}
We initialize a struct to hold extra user parameters. At the lest, we should initialize it as a placeholder containing one variable.


\begin{lstlisting}
(*@\HLJLnd{@with{\_}kw}@*) (*@\HLJLk{mutable struct}@*) (*@\HLJLn{Params}@*) (*@\HLJLoB{<:}@*) (*@\HLJLn{UserParams}@*) (*@\HLJLnd{@deftype}@*) (*@\HLJLn{Float64}@*)
    (*@\HLJLcs{{\#} parameters (at least a placeholder):}@*)
    (*@\HLJLn{\ensuremath{\kappa}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnfB{0.1}@*)
(*@\HLJLk{end}@*)
(*@\HLJLn{par}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{Params}@*)(*@\HLJLp{()}@*)
\end{lstlisting}

\begin{lstlisting}
Main.WeaveSandBox7.Params
  (*@\ensuremath{\kappa}@*): Float64 0.1
\end{lstlisting}


\subsection{Simulation parameters}

\begin{lstlisting}
(*@\HLJLn{L}@*) (*@\HLJLoB{=}@*) (*@\HLJLp{(}@*)(*@\HLJLnfB{60.0}@*)(*@\HLJLp{,)}@*)
(*@\HLJLn{N}@*) (*@\HLJLoB{=}@*) (*@\HLJLp{(}@*)(*@\HLJLni{512}@*)(*@\HLJLp{,)}@*)
(*@\HLJLn{\ensuremath{\mu}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnfB{25.0}@*)
(*@\HLJLn{g}@*) (*@\HLJLoB{=}@*) (*@\HLJLoB{-}@*)(*@\HLJLnfB{0.01}@*)
(*@\HLJLn{\ensuremath{\gamma}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnfB{0.0}@*)
(*@\HLJLn{Ns}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{200}@*)
(*@\HLJLn{\ensuremath{\xi}s}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{2}@*)(*@\HLJLoB{/}@*)(*@\HLJLnf{abs}@*)(*@\HLJLp{(}@*)(*@\HLJLn{g}@*)(*@\HLJLp{)}@*)(*@\HLJLoB{/}@*)(*@\HLJLn{Ns}@*)
(*@\HLJLn{us}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{20}@*)
(*@\HLJLn{tf}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{1}@*)(*@\HLJLn{\ensuremath{\pi}}@*) (*@\HLJLoB{|>}@*) (*@\HLJLn{Float64}@*)
(*@\HLJLn{Nt}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{150}@*)
(*@\HLJLn{t}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{LinRange}@*)(*@\HLJLp{(}@*)(*@\HLJLnfB{0.}@*)(*@\HLJLp{,}@*)(*@\HLJLn{tf}@*)(*@\HLJLp{,}@*)(*@\HLJLn{Nt}@*)(*@\HLJLp{);}@*)
\end{lstlisting}


\section{Initialize simulation}
Create the \texttt{sim} struct holding all parameters.


\begin{lstlisting}
(*@\HLJLn{sim}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{Sim}@*)(*@\HLJLp{(}@*)(*@\HLJLn{L}@*)(*@\HLJLp{,}@*)(*@\HLJLn{N}@*)(*@\HLJLp{,}@*)(*@\HLJLn{par}@*)(*@\HLJLp{)}@*)
(*@\HLJLnd{@pack!}@*) (*@\HLJLn{sim}@*) (*@\HLJLoB{=}@*) (*@\HLJLn{\ensuremath{\mu}}@*)(*@\HLJLp{,}@*)(*@\HLJLn{g}@*)(*@\HLJLp{,}@*)(*@\HLJLn{\ensuremath{\gamma}}@*)(*@\HLJLp{,}@*)(*@\HLJLn{t}@*)(*@\HLJLp{,}@*)(*@\HLJLn{tf}@*)(*@\HLJLp{,}@*)(*@\HLJLn{Nt}@*)
(*@\HLJLnd{@unpack{\_}Sim}@*) (*@\HLJLn{sim}@*)
\end{lstlisting}

\begin{lstlisting}
FourierGPE.Transforms{1}
  Txk: AbstractFFTs.ScaledPlan{Complex{Float64},FFTW.cFFTWPlan{Complex{Floa
t64},-1,false,1},Float64}
  Txk!: AbstractFFTs.ScaledPlan{Complex{Float64},FFTW.cFFTWPlan{Complex{Flo
at64},-1,true,1},Float64}
  Tkx: AbstractFFTs.ScaledPlan{Complex{Float64},FFTW.cFFTWPlan{Complex{Floa
t64},1,false,1},Float64}
  Tkx!: AbstractFFTs.ScaledPlan{Complex{Float64},FFTW.cFFTWPlan{Complex{Flo
at64},1,true,1},Float64}
\end{lstlisting}


\subsection{Initial soliton}
The bright soliton wavefunction is

\[
\psi_s(x)= \sqrt{\frac{N}{2\xi}}\sech{x/\xi}e^{iux}
\]
We initialzie this as


\begin{lstlisting}
(*@\HLJLn{X}@*)(*@\HLJLp{,}@*)(*@\HLJLn{K}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{makearrays}@*)(*@\HLJLp{(}@*)(*@\HLJLn{L}@*)(*@\HLJLp{,}@*)(*@\HLJLn{N}@*)(*@\HLJLp{)}@*)
(*@\HLJLn{x}@*) (*@\HLJLoB{=}@*) (*@\HLJLn{X}@*)(*@\HLJLp{[}@*)(*@\HLJLni{1}@*)(*@\HLJLp{]}@*)
(*@\HLJLnf{\ensuremath{\psi}s}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x}@*)(*@\HLJLp{)}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{sqrt}@*)(*@\HLJLp{(}@*)(*@\HLJLn{Ns}@*)(*@\HLJLoB{/}@*)(*@\HLJLni{2}@*)(*@\HLJLn{\ensuremath{\xi}s}@*)(*@\HLJLp{)}@*)(*@\HLJLoB{*}@*)(*@\HLJLnf{sech}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x}@*)(*@\HLJLoB{/}@*)(*@\HLJLn{\ensuremath{\xi}s}@*)(*@\HLJLp{)}@*)(*@\HLJLoB{*}@*)(*@\HLJLnf{exp}@*)(*@\HLJLp{(}@*)(*@\HLJLn{im}@*)(*@\HLJLoB{*}@*)(*@\HLJLn{us}@*)(*@\HLJLoB{*}@*)(*@\HLJLn{x}@*)(*@\HLJLp{)}@*)
(*@\HLJLn{\ensuremath{\psi}i}@*) (*@\HLJLoB{=}@*) (*@\HLJLn{\ensuremath{\psi}s}@*)(*@\HLJLoB{.}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x}@*)(*@\HLJLp{)}@*)
(*@\HLJLn{\ensuremath{\phi}i}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{kspace}@*)(*@\HLJLp{(}@*)(*@\HLJLn{\ensuremath{\psi}i}@*)(*@\HLJLp{,}@*)(*@\HLJLn{sim}@*)(*@\HLJLp{)}@*)
(*@\HLJLnd{@pack!}@*) (*@\HLJLn{sim}@*) (*@\HLJLoB{=}@*) (*@\HLJLn{\ensuremath{\phi}i}@*)(*@\HLJLp{;}@*)
\end{lstlisting}


\subsection{Evolve in k space}
Now we have everything we need to evolve in k-space


\begin{lstlisting}
(*@\HLJLn{sol}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{runsim}@*)(*@\HLJLp{(}@*)(*@\HLJLn{sim}@*)(*@\HLJLp{)}@*)
\end{lstlisting}

\begin{lstlisting}
1.133512 seconds (1.43 M allocations: 70.149 MiB, 2.40% gc time)
retcode: Success
Interpolation: 1st order linear
t: 150-element Array{Float64,1}:
 0.0                 
 0.021084514453622773
 0.04216902890724555 
 0.06325354336086832 
 0.0843380578144911  
 0.10542257226811386 
 0.12650708672173663 
 0.1475916011753594  
 0.1686761156289822  
 0.18976063008260496 
 (*@\ensuremath{\vdots}@*)                   
 2.9729165379608107  
 2.9940010524144336  
 3.0150855668680565  
 3.0361700813216794  
 3.0572545957753023  
 3.078339110228925   
 3.0994236246825477  
 3.12050813913617    
 3.141592653589793   
u: 150-element Array{Array{Complex{Float64},1},1}:
 [5.91227e-13-1.22131e-14im, -6.77657e-13+1.0643e-14im, 8.12539e-13+1.00091
e-14im, -9.38263e-13-1.84062e-14im, 1.12053e-12+4.86229e-14im, -1.30089e-12
-6.70354e-14im, 1.54731e-12+1.10838e-13im, -1.80257e-12-1.45381e-13im, 2.13
677e-12+2.09628e-13im, -2.49622e-12-2.69717e-13im  (*@\ensuremath{\dots}@*)  1.48233e-13-3.41226e-
14im, -1.50653e-13+4.04521e-14im, 1.86874e-13-3.45021e-14im, -1.96619e-13+4
.06796e-14im, 2.41933e-13-3.32789e-14im, -2.6259e-13+3.92884e-14im, 3.2108e
-13-3.05335e-14im, -3.56535e-13+3.56832e-14im, 4.32855e-13-2.46885e-14im, -
4.90379e-13+2.7034e-14im]    
 [-2.07972e-13+1.04084e-13im, 2.71889e-13-1.10369e-13im, -3.29393e-13+1.498
68e-13im, 4.19307e-13-1.65067e-13im, -5.07596e-13+2.16702e-13im, 6.34651e-1
3-2.44357e-13im, -7.682e-13+3.11868e-13im, 9.49834e-13-3.57806e-13im, -1.14
929e-12+4.47597e-13im, 1.40937e-12-5.21285e-13im  (*@\ensuremath{\dots}@*)  2.04176e-14+2.13174e-1
4im, -1.32703e-15-1.14236e-14im, 8.55215e-16+2.76757e-14im, 2.21079e-14-1.8
7402e-14im, -2.75767e-14+3.74764e-14im, 5.55286e-14-3.00955e-14im, -6.73984
e-14+5.18119e-14im, 1.03241e-13-4.67775e-14im, -1.24916e-13+7.24723e-14im, 
1.71661e-13-7.26608e-14im]   
 [-2.68886e-13+3.89979e-13im, 3.19982e-13-4.49802e-13im, -3.77022e-13+5.590
47e-13im, 4.42772e-13-6.51781e-13im, -5.15931e-13+8.01447e-13im, 5.98058e-1
3-9.39981e-13im, -6.89328e-13+1.144e-12im, 7.9016e-13-1.3455e-12im, -9.0082
5e-13+1.6232e-12im, 1.02097e-12-1.91173e-12im  (*@\ensuremath{\dots}@*)  -1.20361e-14+8.24585e-14i
m, 2.67376e-14-7.67515e-14im, -3.8405e-14+1.05708e-13im, 5.7214e-14-1.0498e
-13im, -7.46678e-14+1.41006e-13im, 9.84144e-14-1.48089e-13im, -1.22413e-13+
1.94351e-13im, 1.53019e-13-2.12584e-13im, -1.85618e-13+2.73093e-13im, 2.252
32e-13-3.09255e-13im]        
 [-2.05414e-13+3.31117e-13im, 2.17214e-13-3.58967e-13im, -2.45806e-13+4.198
74e-13im, 2.58497e-13-4.52611e-13im, -2.89127e-13+5.17737e-13im, 3.02965e-1
3-5.51064e-13im, -3.36803e-13+6.13175e-13im, 3.55579e-13-6.3804e-13im, -3.9
7885e-13+6.85352e-13im, 4.30855e-13-6.88436e-13im  (*@\ensuremath{\dots}@*)  -4.87104e-14+1.00062e
-13im, 5.40693e-14-9.49409e-14im, -7.20428e-14+1.22403e-13im, 7.90529e-14-1
.21487e-13im, -1.0017e-13+1.54009e-13im, 1.08494e-13-1.59021e-13im, -1.3198
6e-13+1.98251e-13im, 1.4145e-13-2.09925e-13im, -1.66982e-13+2.56523e-13im, 
1.78116e-13-2.7698e-13im]    
 [-1.54508e-13-8.87466e-15im, 1.75124e-13+5.98562e-14im, -2.38209e-13-1.045
4e-13im, 2.8931e-13+1.80081e-13im, -3.93725e-13-2.51105e-13im, 4.95899e-13+
3.54718e-13im, -6.65845e-13-4.5455e-13im, 8.49089e-13+5.86111e-13im, -1.118
75e-12-7.10414e-13im, 1.42385e-12+8.59542e-13im  (*@\ensuremath{\dots}@*)  -5.76766e-14+8.58113e-1
4im, 4.93795e-14-7.75761e-14im, -6.62513e-14+8.93871e-14im, 5.75641e-14-7.9
2929e-14im, -7.59144e-14+8.75735e-14im, 6.78589e-14-7.38169e-14im, -8.89495
e-14+7.63359e-14im, 8.3759e-14-5.50139e-14im, -1.10877e-13+4.7369e-14im, 1.
14876e-13-1.44418e-14im]     
 [-3.38896e-13-2.88941e-13im, 4.14534e-13+3.37563e-13im, -5.44401e-13-3.827
74e-13im, 6.6111e-13+4.22617e-13im, -8.35534e-13-4.51724e-13im, 9.95318e-13
+4.66181e-13im, -1.21082e-12-4.61206e-13im, 1.40529e-12+4.3241e-13im, -1.64
584e-12-3.75747e-13im, 1.8524e-12+2.89393e-13im  (*@\ensuremath{\dots}@*)  -6.00294e-14+2.34505e-1
4im, 4.68544e-14-8.34486e-15im, -6.76565e-14-4.65914e-15im, 5.86328e-14+2.6
8493e-14im, -8.67305e-14-4.93003e-14im, 8.69127e-14+7.98947e-14im, -1.28084
e-13-1.12309e-13im, 1.43951e-13+1.52064e-13im, -2.0572e-13-1.9401e-13im, 2.
47503e-13+2.41087e-13im]     
 [-3.47468e-13-2.19062e-13im, 3.70899e-13+2.07503e-13im, -4.14981e-13-2.084
93e-13im, 4.14348e-13+1.92015e-13im, -4.25053e-13-1.97806e-13im, 3.79608e-1
3+1.98661e-13im, -3.36725e-13-2.42195e-13im, 2.31353e-13+3.06817e-13im, -1.
2842e-13-4.4684e-13im, -2.83326e-14+6.47991e-13im  (*@\ensuremath{\dots}@*)  -6.64833e-14-4.73903e
-14im, 5.8786e-14+6.06843e-14im, -8.55845e-14-8.7031e-14im, 8.60341e-14+1.0
3156e-13im, -1.22498e-13-1.32819e-13im, 1.33964e-13+1.48378e-13im, -1.81876
e-13-1.76564e-13im, 2.03818e-13+1.86704e-13im, -2.60712e-13-2.08056e-13im, 
2.89667e-13+2.08602e-13im]   
 [-6.69326e-15-1.53048e-13im, -6.68795e-14+1.804e-13im, 1.36871e-13-2.65883
e-13im, -2.33849e-13+3.59363e-13im, 3.13914e-13-5.29875e-13im, -4.01772e-13
+7.22551e-13im, 4.46408e-13-1.00446e-12im, -4.6666e-13+1.31241e-12im, 4.063
52e-13-1.70334e-12im, -2.8326e-13+2.10207e-12im  (*@\ensuremath{\dots}@*)  -7.18602e-14-9.14528e-1
4im, 7.04055e-14+9.0239e-14im, -9.14763e-14-1.11973e-13im, 9.17949e-14+1.05
693e-13im, -1.11161e-13-1.22952e-13im, 1.0754e-13+1.1014e-13im, -1.17639e-1
3-1.23001e-13im, 9.9772e-14+1.06928e-13im, -8.94349e-14-1.22547e-13im, 4.70
185e-14+1.16946e-13im]       
 [2.98757e-13-3.16669e-13im, -3.42136e-13+4.14728e-13im, 3.64676e-13-5.6848
1e-13im, -3.59371e-13+7.0206e-13im, 3.20001e-13-8.74484e-13im, -2.45676e-13
+9.98823e-13im, 1.42141e-13-1.12975e-12im, -2.36289e-14+1.17627e-12im, -8.6
1932e-14-1.19633e-12im, 1.51804e-13+1.11037e-12im  (*@\ensuremath{\dots}@*)  -4.87939e-14-8.8102e-
14im, 4.30844e-14+7.01485e-14im, -3.86982e-14-8.24942e-14im, 2.19448e-14+6.
19231e-14im, -1.10896e-15-7.63432e-14im, -3.29044e-14+6.24485e-14im, 7.3936
5e-14-9.14139e-14im, -1.26397e-13+9.94496e-14im, 1.8338e-13-1.60173e-13im, 
-2.43692e-13+2.09317e-13im]  
 [2.37456e-13-3.55626e-13im, -2.01864e-13+3.74196e-13im, 1.7893e-13-3.93704
e-13im, -1.49411e-13+3.45867e-13im, 1.68371e-13-2.88439e-13im, -2.24633e-13
+1.64024e-13im, 3.80514e-13-5.07631e-14im, -6.2221e-13-8.64463e-14im, 9.992
01e-13+1.43765e-13im, -1.4749e-12-1.34233e-13im  (*@\ensuremath{\dots}@*)  9.68939e-15-6.14604e-14
im, -2.4252e-14+4.11025e-14im, 5.60703e-14-5.53212e-14im, -8.28755e-14+4.49
778e-14im, 1.26951e-13-7.47607e-14im, -1.58994e-13+8.52909e-14im, 2.02884e-
13-1.38932e-13im, -2.24272e-13+1.72824e-13im, 2.49402e-13-2.4531e-13im, -2.
43439e-13+2.89433e-13im]     
 (*@\ensuremath{\vdots}@*)                                                                         
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           
                                                                           
                             
 [-1.27348e-13-3.30217e-13im, -9.44741e-13+7.04487e-13im, 1.03777e-13-5.003
7e-13im, -1.66727e-12+6.47529e-13im, 4.23148e-13-5.60217e-13im, -2.49989e-1
2+3.39471e-13im, 5.54669e-13-4.2904e-13im, -3.07503e-12-2.60517e-13im, -1.0
5858e-13-1.38858e-13im, -2.7316e-12-1.0105e-12im  (*@\ensuremath{\dots}@*)  -5.84252e-14+4.76922e-
14im, 1.94285e-13+1.30935e-13im, -8.26128e-14+5.12947e-14im, 1.38726e-13+2.
44595e-13im, -1.32921e-13+4.11331e-14im, 3.7243e-14+3.59701e-13im, -1.93198
e-13-1.91723e-14im, -1.36995e-13+4.87581e-13im, -2.13096e-13-1.4848e-13im, 
-4.42673e-13+6.1943e-13im]   
 [1.17979e-13-3.0084e-13im, -1.24802e-12+7.33761e-14im, 4.36554e-13-3.04052
e-13im, -1.8835e-12-3.74899e-13im, 7.87545e-13-1.47041e-13im, -2.50137e-12-
1.11834e-12im, 8.91422e-13+1.10539e-13im, -2.76525e-12-2.01728e-12im, 2.409
29e-13+1.52546e-13im, -2.17639e-12-2.63532e-12im  (*@\ensuremath{\dots}@*)  -6.36656e-14+2.24289e-
14im, 9.17039e-14+1.98243e-13im, -8.30186e-14+1.7382e-14im, -1.78557e-14+2.
64893e-13im, -1.1679e-13-1.18024e-14im, -1.70014e-13+3.08214e-13im, -1.3101
e-13-8.83963e-14im, -3.9556e-13+3.23979e-13im, -6.97962e-14-2.01795e-13im, 
-7.43722e-13+2.72742e-13im]  
 [2.32761e-13-2.31691e-13im, -1.09188e-12-5.20033e-13im, 5.03158e-13-1.0500
9e-13im, -1.41038e-12-1.18588e-12im, 7.22548e-13+1.54881e-13im, -1.57216e-1
2-2.07145e-12im, 6.84694e-13+3.47952e-13im, -1.36447e-12-2.87989e-12im, 1.1
2413e-13-5.91968e-14im, -5.77292e-13-2.979e-12im  (*@\ensuremath{\dots}@*)  -7.25692e-14-5.27562e-
15im, -1.13444e-14+2.11679e-13im, -8.87279e-14-2.11706e-14im, -1.38456e-13+
2.17226e-13im, -1.05213e-13-6.68779e-14im, -2.90517e-13+1.82499e-13im, -8.1
1391e-14-1.46137e-13im, -4.9117e-13+8.97053e-14im, 2.56556e-14-2.23234e-13i
m, -7.6224e-13-1.17199e-13im]
 [2.5419e-13-1.90524e-14im, -6.06263e-13-1.07385e-12im, 3.96749e-13+2.51226
e-13im, -5.14613e-13-1.84012e-12im, 4.14827e-13+6.24184e-13im, -1.62778e-13
-2.7346e-12im, 2.22114e-13+8.30262e-13im, 4.93274e-13-3.40309e-12im, -1.697
28e-13+2.78168e-13im, 1.33641e-12-3.20491e-12im  (*@\ensuremath{\dots}@*)  -7.06945e-14-2.54226e-1
4im, -1.02504e-13+1.6082e-13im, -8.10473e-14-4.20323e-14im, -2.10698e-13+9.
56983e-14im, -7.89984e-14-8.31206e-14im, -3.17176e-13-1.88961e-14im, -2.787
31e-14-1.31e-13im, -4.3262e-13-2.10501e-13im, 8.98575e-14-1.32426e-13im, -5
.46669e-13-5.39739e-13im]    
 [2.87924e-13+1.90074e-13im, -5.86362e-14-1.3259e-12im, 3.11672e-13+5.25196
e-13im, 3.58463e-13-1.97562e-12im, 1.98632e-13+8.92744e-13im, 1.03459e-12-2
.61368e-12im, 2.19141e-14+1.01634e-12im, 1.81524e-12-2.91344e-12im, 1.01084
e-13+3.88274e-13im, 2.26363e-12-2.37736e-12im  (*@\ensuremath{\dots}@*)  -4.46962e-14-4.50953e-14i
m, -1.74171e-13+7.46549e-14im, -4.22927e-14-5.93481e-14im, -2.39819e-13-4.3
0641e-14im, -1.44775e-14-8.5835e-14im, -2.81463e-13-2.06287e-13im, 6.29017e
-14-8.94655e-14im, -2.96121e-13-4.45082e-13im, 1.79997e-13-1.4101e-14im, -2
.4693e-13-8.07585e-13im]     
 [2.20832e-13+2.48192e-13im, 5.37692e-13-1.09721e-12im, 9.58223e-14+5.10165
e-13im, 1.19928e-12-1.39966e-12im, -1.61049e-13+7.07378e-13im, 2.07878e-12-
1.53531e-12im, -3.56582e-13+6.26037e-13im, 2.89226e-12-1.28768e-12im, 1.980
12e-14-3.11946e-14im, 3.03997e-12-4.25528e-13im  (*@\ensuremath{\dots}@*)  8.37754e-16-6.65558e-14
im, -2.07904e-13-1.442e-14im, 1.47989e-14-8.13764e-14im, -2.11332e-13-1.455
77e-13im, 5.8499e-14-9.57832e-14im, -1.72569e-13-3.01532e-13im, 1.36253e-13
-6.86067e-14im, -7.53758e-14-5.04651e-13im, 2.12447e-13+4.1285e-14im, 1.347
36e-13-7.74785e-13im]        
 [3.81838e-14+2.40826e-13im, 1.06414e-12-5.80111e-13im, -2.47458e-13+3.7865
6e-13im, 1.84797e-12-4.86459e-13im, -6.45352e-13+4.01554e-13im, 2.77308e-12
-1.56528e-13im, -8.91574e-13+2.38496e-13im, 3.49624e-12+4.3088e-13im, -4.03
039e-13-8.70231e-14im, 3.38741e-12+1.14369e-12im  (*@\ensuremath{\dots}@*)  4.36301e-14-6.62598e-1
4im, -1.84443e-13-1.03583e-13im, 6.4834e-14-7.89416e-14im, -1.2259e-13-2.11
174e-13im, 1.10092e-13-7.97362e-14im, -8.83626e-15-3.14686e-13im, 1.60166e-
13-3.17345e-14im, 1.84684e-13-4.24323e-13im, 1.59615e-13+8.2017e-14im, 5.19
55e-13-5.29753e-13im]        
 [-1.55382e-13+1.89885e-13im, 1.30568e-12+5.88869e-14im, -5.26883e-13+2.009
54e-13im, 1.99222e-12+4.73022e-13im, -9.31607e-13+1.09532e-13im, 2.66266e-1
2+1.09875e-12im, -1.07022e-12-1.75478e-16im, 2.96665e-12+1.77708e-12im, -3.
95043e-13+1.72997e-13im, 2.36388e-12+2.10718e-12im  (*@\ensuremath{\dots}@*)  7.64586e-14-3.11771e
-14im, -1.17398e-13-1.83975e-13im, 1.05899e-13-3.72803e-14im, -1.2479e-14-2
.3812e-13im, 1.45781e-13-2.65504e-14im, 1.42547e-13-2.57005e-13im, 1.55317e
-13+2.52415e-14im, 3.82336e-13-2.39405e-13im, 7.244e-14+1.11071e-13im, 7.59
13e-13-1.54917e-13im]        
 [-2.88285e-13+1.84934e-13im, 1.13664e-12+5.70471e-13im, -5.57358e-13+8.402
33e-14im, 1.43045e-12+1.20173e-12im, -7.30051e-13-1.44741e-13im, 1.52859e-1
2+2.05784e-12im, -5.88891e-13-3.41436e-13im, 1.22874e-12+2.90012e-12im, 1.4
6394e-13-5.33889e-14im, 3.39582e-13+3.19254e-12im  (*@\ensuremath{\dots}@*)  8.38855e-14-3.51444e-
16im, -9.31287e-15-2.03628e-13im, 1.03176e-13+3.14566e-15im, 1.22763e-13-1.
94343e-13im, 1.14905e-13+3.27291e-14im, 2.87826e-13-1.39007e-13im, 7.4329e-
14+9.73948e-14im, 5.08754e-13-2.84061e-14im, -5.83928e-14+1.68039e-13im, 8.
00498e-13+1.83455e-13im]
\end{lstlisting}


\subsection{Plot the solution}
\begin{verbatim}
y = abs2.(xspace(sol[Nt-76],sim))
plot(x,y,fill=(0, 0.2),size=(600,150),legend=false,grid=false,xticks=false,yticks=false,axis=false)
\end{verbatim}
or we can make an animation



\begin{lstlisting}
(*@\HLJLn{anim}@*) (*@\HLJLoB{=}@*) (*@\HLJLnd{@animate}@*) (*@\HLJLk{for}@*) (*@\HLJLn{i}@*)(*@\HLJLoB{=}@*)(*@\HLJLni{1}@*)(*@\HLJLoB{:}@*)(*@\HLJLn{Nt}@*)(*@\HLJLoB{-}@*)(*@\HLJLni{8}@*)
    (*@\HLJLn{\ensuremath{\psi}}@*) (*@\HLJLoB{=}@*) (*@\HLJLnf{xspace}@*)(*@\HLJLp{(}@*)(*@\HLJLn{sol}@*)(*@\HLJLp{[}@*)(*@\HLJLn{i}@*)(*@\HLJLp{],}@*)(*@\HLJLn{sim}@*)(*@\HLJLp{)}@*)
    (*@\HLJLn{y}@*)(*@\HLJLoB{=}@*)(*@\HLJLn{abs2}@*)(*@\HLJLoB{.}@*)(*@\HLJLp{(}@*)(*@\HLJLn{\ensuremath{\psi}}@*)(*@\HLJLp{)}@*)
    (*@\HLJLnf{plot}@*)(*@\HLJLp{(}@*)(*@\HLJLn{x}@*)(*@\HLJLp{,}@*)(*@\HLJLn{y}@*)(*@\HLJLp{,}@*)(*@\HLJLn{fill}@*)(*@\HLJLoB{=}@*)(*@\HLJLp{(}@*)(*@\HLJLni{0}@*)(*@\HLJLp{,}@*) (*@\HLJLnfB{0.2}@*)(*@\HLJLp{),}@*)(*@\HLJLn{size}@*)(*@\HLJLoB{=}@*)(*@\HLJLp{(}@*)(*@\HLJLni{600}@*)(*@\HLJLp{,}@*)(*@\HLJLni{150}@*)(*@\HLJLp{),}@*)(*@\HLJLn{legend}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{,}@*)(*@\HLJLn{grid}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{,}@*)(*@\HLJLn{xticks}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{,}@*)(*@\HLJLn{yticks}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{,}@*)(*@\HLJLn{axis}@*)(*@\HLJLoB{=}@*)(*@\HLJLkc{false}@*)(*@\HLJLp{)}@*)
(*@\HLJLk{end}@*)

(*@\HLJLnf{gif}@*)(*@\HLJLp{(}@*)(*@\HLJLn{anim}@*)(*@\HLJLp{,}@*) (*@\HLJLs{"./examples/brightsoliton.gif"}@*)(*@\HLJLp{,}@*) (*@\HLJLn{fps}@*) (*@\HLJLoB{=}@*) (*@\HLJLni{25}@*)(*@\HLJLp{)}@*)
\end{lstlisting}


\end{document}
