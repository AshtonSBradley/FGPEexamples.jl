<!DOCTYPE html>
<HTML lang = "en">
<HEAD>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Jones-Roberts soliton motion in a homogeneous BEC</title>
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  
<style>
pre.hljl {
    border: 1px solid #ccc;
    margin: 5px;
    padding: 5px;
    overflow-x: auto;
    color: rgb(68,68,68); background-color: rgb(251,251,251); }
pre.hljl > span.hljl-t { }
pre.hljl > span.hljl-w { }
pre.hljl > span.hljl-e { }
pre.hljl > span.hljl-eB { }
pre.hljl > span.hljl-o { }
pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; }
pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; }
pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-n { }
pre.hljl > span.hljl-na { }
pre.hljl > span.hljl-nb { }
pre.hljl > span.hljl-nbp { }
pre.hljl > span.hljl-nc { }
pre.hljl > span.hljl-ncB { }
pre.hljl > span.hljl-nd { color: rgb(214,102,97); }
pre.hljl > span.hljl-ne { }
pre.hljl > span.hljl-neB { }
pre.hljl > span.hljl-nf { color: rgb(66,102,213); }
pre.hljl > span.hljl-nfm { color: rgb(66,102,213); }
pre.hljl > span.hljl-np { }
pre.hljl > span.hljl-nl { }
pre.hljl > span.hljl-nn { }
pre.hljl > span.hljl-no { }
pre.hljl > span.hljl-nt { }
pre.hljl > span.hljl-nv { }
pre.hljl > span.hljl-nvc { }
pre.hljl > span.hljl-nvg { }
pre.hljl > span.hljl-nvi { }
pre.hljl > span.hljl-nvm { }
pre.hljl > span.hljl-l { }
pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; }
pre.hljl > span.hljl-s { color: rgb(201,61,57); }
pre.hljl > span.hljl-sa { color: rgb(201,61,57); }
pre.hljl > span.hljl-sb { color: rgb(201,61,57); }
pre.hljl > span.hljl-sc { color: rgb(201,61,57); }
pre.hljl > span.hljl-sd { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdB { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdC { color: rgb(201,61,57); }
pre.hljl > span.hljl-se { color: rgb(59,151,46); }
pre.hljl > span.hljl-sh { color: rgb(201,61,57); }
pre.hljl > span.hljl-si { }
pre.hljl > span.hljl-so { color: rgb(201,61,57); }
pre.hljl > span.hljl-sr { color: rgb(201,61,57); }
pre.hljl > span.hljl-ss { color: rgb(201,61,57); }
pre.hljl > span.hljl-ssB { color: rgb(201,61,57); }
pre.hljl > span.hljl-nB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nbB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nfB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nh { color: rgb(59,151,46); }
pre.hljl > span.hljl-ni { color: rgb(59,151,46); }
pre.hljl > span.hljl-nil { color: rgb(59,151,46); }
pre.hljl > span.hljl-noB { color: rgb(59,151,46); }
pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-p { }
pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-g { }
pre.hljl > span.hljl-gd { }
pre.hljl > span.hljl-ge { }
pre.hljl > span.hljl-geB { }
pre.hljl > span.hljl-gh { }
pre.hljl > span.hljl-gi { }
pre.hljl > span.hljl-go { }
pre.hljl > span.hljl-gp { }
pre.hljl > span.hljl-gs { }
pre.hljl > span.hljl-gsB { }
pre.hljl > span.hljl-gt { }
</style>



  <style type="text/css">
  @font-face {
  font-style: normal;
  font-weight: 300;
}
@font-face {
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-style: normal;
  font-weight: 600;
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  font-family: monospace, monospace;
  font-size : 0.8em;
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
thead th {
    border-bottom: 1px solid black;
    background-color: white;
}
tr:nth-child(odd){
  background-color: rgb(248,248,248);
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle; }
ol {
  list-style: decimal; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li > p {margin : 0;}
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 1.0rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre.hljl {
  margin: 0 0 10px;
  display: block;
  background: #f5f5f5;
  border-radius: 4px;
  padding : 5px;
}

pre.output {
  background: #ffffff;
}

pre.code {
  background: #ffffff;
}

pre.julia-error {
  color : red
}

code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
  font-size: 13px;
}


@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

h1.title {margin-top : 20px}
img {max-width : 100%}
div.title {text-align: center;}

  </style>



</HEAD>
  <BODY>
    <div class ="container">
      <div class = "row">
        <div class = "col-md-12 twelve columns">

          <div class="title">
            <h1 class="title">Jones-Roberts soliton motion in a homogeneous BEC</h1>
            <h5>Sukla Pal</h5>
            
          </div>

          <h1>Introduction</h1>
<p>In this example we simulate the precession of a single quantum vortex in a harmonic trap, and compare with the analytical result found by Fetter.</p>
<p>As simple model of this process, we start with the damped GPE</p>
<p class="math">\[
i\hbar\partial_t\psi = (1-i\gamma)(L-\mu)\psi
\]</p>
<p>where the GP operator is defined as</p>
<p class="math">\[
L\psi\equiv \left(-\frac{\hbar^2\nabla^2}{2m}+V(\mathbf{r})+g|\psi|^2\right)\psi
\]</p>
<p>and as usual the S-wave interaction parameter is <span class="math">$g=4\pi\hbar^2 a/m$</span> for S-wave scattering lenght <span class="math">$a$</span>.</p>
<p>The trap is chosen to be trivial</p>
<p class="math">\[
V(\mathbf{r})=0
\]</p>
<p>The number <span class="math">$\gamma\ll 1$</span> describes irreversable interactons between condensate and noncondensate atoms, inducing condensate growth.</p>
<h1>Loading the package</h1>
<p>First, we load some useful packages, setting defaults for <code>Plots</code>.</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Plots</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>LaTeXStrings</span><span class='hljl-t'>
</span><span class='hljl-nf'>gr</span><span class='hljl-p'>(</span><span class='hljl-n'>titlefontsize</span><span class='hljl-oB'>=</span><span class='hljl-ni'>12</span><span class='hljl-p'>,</span><span class='hljl-n'>size</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-ni'>500</span><span class='hljl-p'>,</span><span class='hljl-ni'>300</span><span class='hljl-p'>),</span><span class='hljl-n'>transpose</span><span class='hljl-oB'>=</span><span class='hljl-kc'>true</span><span class='hljl-p'>,</span><span class='hljl-n'>colorbar</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Plots.GRBackend&#40;&#41;
</pre>


<p>Now load <code>FourierGPE</code></p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>FourierGPE</span>
</pre>



<p>In this example, we work in oscillator units. The units of length and time are <span class="math">$a_\perp=\sqrt{\hbar/m\omega_\perp}$</span> and <span class="math">$1/\omega_\perp$</span> respectively.</p>
<h1>Initialize simulation</h1>
<p>Initialize default sim with domain and grid parameters</p>


<pre class='hljl'>
<span class='hljl-n'>L</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>20.0</span><span class='hljl-p'>,</span><span class='hljl-nfB'>20.0</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>N</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-ni'>128</span><span class='hljl-p'>,</span><span class='hljl-ni'>128</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>sim</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Sim</span><span class='hljl-p'>(</span><span class='hljl-n'>L</span><span class='hljl-p'>,</span><span class='hljl-n'>N</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nd'>@unpack_Sim</span><span class='hljl-t'> </span><span class='hljl-n'>sim</span><span class='hljl-p'>;</span>
</pre>



<h1>Declare the potential</h1>


<pre class='hljl'>
<span class='hljl-k'>import</span><span class='hljl-t'> </span><span class='hljl-n'>FourierGPE</span><span class='hljl-oB'>.</span><span class='hljl-n'>V</span><span class='hljl-t'>
</span><span class='hljl-nf'>V</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>t</span><span class='hljl-p'>)</span><span class='hljl-oB'>::</span><span class='hljl-n'>Float64</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span>
</pre>


<pre class="output">
V &#40;generic function with 3 methods&#41;
</pre>


<h1>Thomas-Fermi initial state</h1>


<pre class='hljl'>
<span class='hljl-nf'>ψ0</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-n'>g</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-n'>μ</span><span class='hljl-oB'>/</span><span class='hljl-n'>g</span><span class='hljl-p'>)</span><span class='hljl-oB'>*</span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-nf'>max</span><span class='hljl-p'>(</span><span class='hljl-nfB'>1.0</span><span class='hljl-oB'>-</span><span class='hljl-nf'>V</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>)</span><span class='hljl-oB'>/</span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>)</span><span class='hljl-oB'>+</span><span class='hljl-n'>im</span><span class='hljl-oB'>*</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>X</span><span class='hljl-t'>

</span><span class='hljl-n'>μ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>25.0</span><span class='hljl-t'>
</span><span class='hljl-n'>ψi</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>ψ0</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-oB'>&#39;</span><span class='hljl-p'>,</span><span class='hljl-n'>μ</span><span class='hljl-p'>,</span><span class='hljl-n'>g</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>ϕi</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>kspace</span><span class='hljl-p'>(</span><span class='hljl-n'>ψi</span><span class='hljl-p'>,</span><span class='hljl-n'>sim</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nd'>@pack_Sim!</span><span class='hljl-t'> </span><span class='hljl-n'>sim</span><span class='hljl-p'>;</span>
</pre>



<h1>Imaginary-time evolution in k space</h1>


<pre class='hljl'>
<span class='hljl-nd'>@time</span><span class='hljl-t'> </span><span class='hljl-n'>sol</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>runsim</span><span class='hljl-p'>(</span><span class='hljl-n'>sim</span><span class='hljl-p'>);</span>
</pre>


<pre class="output">
1.238931 seconds &#40;3.47 M allocations: 205.226 MiB, 2.89&#37; gc time&#41;
</pre>


<p>Let&#39;s pull out the final state and verify that it is indeed the ground state of the harmonic trap:</p>


<pre class='hljl'>
<span class='hljl-n'>ϕg</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>sol</span><span class='hljl-p'>[</span><span class='hljl-k'>end</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>ψg</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>xspace</span><span class='hljl-p'>(</span><span class='hljl-n'>ϕg</span><span class='hljl-p'>,</span><span class='hljl-n'>sim</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>showpsi</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>ψg</span><span class='hljl-p'>)</span>
</pre>


<img src="data:image/png;base64,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"  />

<h1>Imprint Jones-Roberts soliton</h1>
<p>We imprint a JR-soliton using the <a href="https://dx.doi.org/">analytical solution</a></p>
<h1>Set simulation parameters</h1>
<p>Let&#39;s evolve for one period of Hamiltonian dynamics, as predicted by the Thomas-Fermi analysis:</p>


<pre class='hljl'>
<span class='hljl-n'>γ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0</span><span class='hljl-t'>
</span><span class='hljl-n'>ϕi</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>kspace</span><span class='hljl-p'>(</span><span class='hljl-n'>ψg</span><span class='hljl-p'>,</span><span class='hljl-n'>sim</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nd'>@pack_Sim!</span><span class='hljl-t'> </span><span class='hljl-n'>sim</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-cs'># write over previous sim  and reuse</span>
</pre>



<h1>Evolve in k space</h1>


<pre class='hljl'>
<span class='hljl-n'>solv</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>runsim</span><span class='hljl-p'>(</span><span class='hljl-n'>sim</span><span class='hljl-p'>);</span>
</pre>



<p>Pull out a state after some evolution</p>


<pre class='hljl'>
<span class='hljl-n'>ϕf</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>solv</span><span class='hljl-p'>[</span><span class='hljl-ni'>100</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-n'>ψf</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>xspace</span><span class='hljl-p'>(</span><span class='hljl-n'>ϕf</span><span class='hljl-p'>,</span><span class='hljl-n'>sim</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>showpsi</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>ψf</span><span class='hljl-p'>)</span>
</pre>


<img src="data:image/png;base64,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"  />

<p>We can trim the last few frames to show one orbit</p>


<pre class='hljl'>
<span class='hljl-n'>anim</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@animate</span><span class='hljl-t'> </span><span class='hljl-k'>for</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-n'>Nt</span><span class='hljl-oB'>-</span><span class='hljl-ni'>6</span><span class='hljl-t'>
    </span><span class='hljl-n'>ψ</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>xspace</span><span class='hljl-p'>(</span><span class='hljl-n'>solv</span><span class='hljl-p'>[</span><span class='hljl-n'>i</span><span class='hljl-p'>],</span><span class='hljl-n'>sim</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-nf'>showpsi</span><span class='hljl-p'>(</span><span class='hljl-n'>x</span><span class='hljl-p'>,</span><span class='hljl-n'>y</span><span class='hljl-p'>,</span><span class='hljl-n'>ψ</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-p'>;</span>
</pre>



<p>and save the animation to the <a href="../../media/jrsoliton.gif">media folder</a></p>


<pre class='hljl'>
<span class='hljl-nf'>gif</span><span class='hljl-p'>(</span><span class='hljl-n'>anim</span><span class='hljl-p'>,</span><span class='hljl-s'>&quot;./media/jrsoliton.gif&quot;</span><span class='hljl-p'>,</span><span class='hljl-n'>fps</span><span class='hljl-oB'>=</span><span class='hljl-ni'>30</span><span class='hljl-p'>)</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: stringmime not defined
</pre>


<p>discuss...</p>



          <HR/>
          <div class="footer"><p>
          Published from <a href="jrsoliton.jmd">jrsoliton.jmd</a> using
          <a href="http://github.com/mpastell/Weave.jl">Weave.jl</a>
           on 2019-11-06.
          <p></div>


        </div>
      </div>
    </div>
  </BODY>
</HTML>
